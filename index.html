<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport"content="width=device-width, initial-scale=1.0, minimum-scale=0.5, maximum-scale=2.0, user-scalable=yes"><script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script><style>input{font-size:medium;padding:3px;margin-top:3px}hr{width:350px}</style></head><body style="font-size: large;"><div style="text-align: center; margin-left: 20px; margin-right: 20px;"><h1 style="font-size: xx-large;">随机抽取学号</h1><div>最小值（包括）：<input type="text"id="nv_input"></div><div style="margin-top: 10px;">最大值（包括）：<input type="text"id="mv_input"></div><hr><div style="font-size: medium; margin-top: 10px; cursor: pointer;"id="specify_title">为个别学号调整概率</div><div style="display: none;" id="specify_form"><div style="margin-top: 20px;">指定的学号：<input type="text"id="sid"></div><div style="margin-top: 10px;">概率调整到：<input type="text"id="spr"></div><p style="font-size: small;">多个指定的学号请用空格分开<br/>“概率调整到”字段请填入一个0到1之间（均包含）的小数<br/>不指定概率时两字段应均为空</p></div><hr style="margin-top: 10px;"><h3 id="nd"style="height: max-content;">学号</h3><button id="get_number"style="margin-top: 10px; padding-top: 5px; padding-bottom: 5px; padding-left: 10px; padding-right: 10px; font-size: large;">抽取</button></div><script type="text/javascript">var prevmin=0,prevmax=0;var grd=function(){return window.crypto.getRandomValues(new Uint32Array(1))[0]};var gir=function(nv,mv){return grd()%(mv-nv+1)+nv};class random_heap{constructor(nvue,mvue){this.nv=nvue;this.mv=mvue;this.heap=new Uint32Array(mvue-nvue+2);for(var i=1;i<=mvue-nvue+1;++i){this.heap[i]=nvue+i-1}for(var i=1;i<=mvue-nvue;++i){var ind=gir(i,mvue-nvue+1);var t=this.heap[i];this.heap[i]=this.heap[ind];this.heap[ind]=t}}gi=function(){var index=1,prev=0;for(;;){prev=index;index=(index<<1)|(grd()&1);if(index>this.mv-this.nv+1){break}var t=this.heap[prev];this.heap[prev]=this.heap[index];this.heap[index]=t}return this.heap[1]}};var rndhp;var sn=[];$(function(){if(window.localStorage.getItem("minval")!=null&&window.localStorage.getItem("maxval")!=null){$("#nv_input").val(parseInt(window.localStorage.getItem("minval")));$("#mv_input").val(parseInt(window.localStorage.getItem("maxval")))}});$("#specify_title").click(function(){$("#specify_form").slideToggle()});$("#get_number").click(function(){var nv=$("#nv_input").val();var mv=$("#mv_input").val();nv=parseInt(nv);mv=parseInt(mv);if(isNaN(nv)||isNaN(mv)||nv==null||mv==null){alert("最大值或最小值输入内容有误，请检查格式")}else{if($("#sid, #spr").val().replace(" ","")!=""){var err="概率调整部分输入内容有误，请检查格式";sn=[];$("#sid").val().split(" ").forEach(function(val,ind,self){var intval=parseInt(val);if(intval==null)return;if(isNaN(intval)){alert(err);return}sn.push(intval)});var pr=parseFloat($("#spr").val());if(pr==null||isNaN(pr)||pr<0||pr>1){alert(err);return}if(grd()<pr*4294967296.0){$("#nd").text(sn[grd()%sn.length].toString());return}}var rnd=0;if(mv-nv+1>=256){rnd=grd();rnd=rnd%(mv-nv+1)+nv}else{if(nv!=prevmin||mv!=prevmax){rndhp=new random_heap((prevmin=nv),(prevmax=mv))}var count=0;do{rnd=rndhp.gi();++count}while(sn.includes(rnd)&&count<=mv-nv+1)}$("#nd").text(rnd.toString());window.localStorage.setItem("minval",nv.toString());window.localStorage.setItem("maxval",mv.toString())}});</script></body></html>
